#!/usr/bin/env bash
# with-packages nix-wrapped cachix
tmpdir=$(mktemp -d)
result="$tmpdir"/result
cd ~/cfg
git add . -N
nix build \
  .#switch-to-configuration.switch.$(hostname -s) \
  --out-link "$result" \
  && cachix push kwbauson "$result"
rm -f "$result"
rmdir "$tmpdir"
